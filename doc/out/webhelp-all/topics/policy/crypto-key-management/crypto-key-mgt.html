<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" data-whc_version="26.1">
    <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="DC.rights.owner" content="(C) Copyright 2024"/><meta name="copyright" content="(C) Copyright 2024"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="dita"/><meta name="description" content="Information security policy"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="wpr-encryption"/>        
      <title>Cryptographic key management</title><!--  Generated with Oxygen version 26.1, build number 2024072909.  --><meta name="wh-path2root" content="../../../"/><meta name="wh-toc-id" content="wpr-encryption-d879e1321"/><meta name="wh-source-relpath" content="topics/policy/crypto-key-management/crypto-key-mgt.dita"/><meta name="wh-out-relpath" content="topics/policy/crypto-key-management/crypto-key-mgt.html"/>

    <link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/app/commons.css?buildId=2024072909"/>
    <link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/app/topic.css?buildId=2024072909"/>

    <script src="../../../oxygen-webhelp/app/options/properties.js?buildId=20241003120633"></script>
    <script src="../../../oxygen-webhelp/app/localization/strings.js?buildId=2024072909"></script>
    <script src="../../../oxygen-webhelp/app/search/index/keywords.js?buildId=20241003120633"></script>
    <script defer="defer" src="../../../oxygen-webhelp/app/commons.js?buildId=2024072909"></script>
    <script defer="defer" src="../../../oxygen-webhelp/app/topic.js?buildId=2024072909"></script>
<link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/template/light.css?buildId=2024072909"/><link rel="stylesheet" type="text/css" href="../../../webhelp.css"/></head>

    <body class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            Jump to main content
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    
                    <div class=" wh_publication_title "><a href="../../../index.html"><span class="title">RJOSE technical writing samples</span></a></div>
                    
                </div>
                
                <button type="button" data-target="#wh_top_menu_and_indexterms_link" id="wh_menu_mobile_button" data-toggle="collapse" class="navbar-toggler collapsed wh_toggle_button" aria-expanded="false" aria-label="Toggle menu" aria-controls="wh_top_menu_and_indexterms_link">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                <nav class=" wh_top_menu " aria-label="Menu Container"><ul role="menubar" aria-label="Menu"><li role="menuitem"><span id="tocId-d879e20-mi" data-tocid="tocId-d879e20" data-state="leaf" class=" topicref "><span class="title"><a href="../../../resume/rjose-resume.pdf">Resume</a></span></span></li><li role="menuitem"><span id="wpr-chg-mgt-processes-d879e28-mi" data-tocid="wpr-chg-mgt-processes-d879e28" data-state="leaf" class=" topicref " data-id="wpr-chg-mgt-processes"><span class="title"><a href="../../../topics/aboutTheSamples.html">About the writing samples</a></span></span></li><li role="menuitem" aria-haspopup="true" aria-expanded="false" class="has-children"><span id="my-rest-api-d879e94-mi" data-tocid="my-rest-api-d879e94" data-state="not-ready" class=" topicref " data-id="my-rest-api"><span class="title"><a href="../../../topics/reference/api-my-rest-api.html">My REST API</a></span></span></li><li role="menuitem" aria-haspopup="true" aria-expanded="false" class="has-children"><span id="sdk-xmen-d879e710-mi" data-tocid="sdk-xmen-d879e710" data-state="not-ready" class=" topicref " data-id="sdk-xmen"><span class="title"><a href="../../../topics/reference/sdk/sdk-xmen.html">My Java class library</a></span></span></li><li role="menuitem" aria-haspopup="true" aria-expanded="false" class="has-children"><span id="api-testing-postman-d879e867-mi" data-tocid="api-testing-postman-d879e867" data-state="not-ready" class=" topicref " data-id="api-testing-postman"><span class="title"><a href="../../../topics/api-testing-postman.html">API testing with Postman</a></span></span></li><li role="menuitem" aria-haspopup="true" aria-expanded="false" class="has-children"><span id="wpr-encryption-d879e1321-mi" data-tocid="wpr-encryption-d879e1321" data-state="not-ready" class=" topicref " data-id="wpr-encryption"><span class="title"><a href="../../../topics/policy/crypto-key-management/crypto-key-mgt.html">Cryptographic key management</a></span></span></li><li role="menuitem" aria-haspopup="true" aria-expanded="false" class="has-children"><span id="chg-mgt-partner-onboarding-proc-d879e1389-mi" data-tocid="chg-mgt-partner-onboarding-proc-d879e1389" data-state="not-ready" class=" topicref " data-id="chg-mgt-partner-onboarding-proc"><span class="title"><a href="../../../topics/process/chg-mgt-partner-onboarding-intro.html"><span class="ph">Shop with PointsÂ®</span> partner onboarding</a></span></span></li><li role="menuitem" aria-haspopup="true" aria-expanded="false" class="has-children"><span id="spec-product-data-d879e1518-mi" data-tocid="spec-product-data-d879e1518" data-state="not-ready" class=" topicref " data-id="spec-product-data"><span class="title"><a href="../../../topics/spec/spec-product-data.html">Product catalog feed specification</a></span></span></li></ul></nav>
                
                
            </div>
        </div>
    </div>
</header>
        
        
         
        
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../../../search.html"><div><input type="search" placeholder="Search " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="Search query" required="required"/><button type="submit" class="wh_search_button" aria-label="Search"><span class="search_input_text">Search</span></button></div></form>
            
            
            
        </div>
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="../../../index.html"><span>Home</span></a></span></li><li class="active"><div class="topicref" data-id="wpr-encryption"><div class="title"><a href="../../../topics/policy/crypto-key-management/crypto-key-mgt.html">Cryptographic key management</a><div class="wh-tooltip"><p class="shortdesc">Information security policy</p></div></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="Toggle search highlights" title="Toggle search highlights"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="Collapse sections" title="Collapse sections"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div>
                        
                        
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                    
                    <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12" id="wh_topic_body">
                        
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="" role="article" aria-labelledby="ariaid-title1"><article class="nested0" aria-labelledby="ariaid-title1" id="wpr-encryption">
    <h1 class="- topic/title title topictitle1" id="ariaid-title1">Cryptographic key management</h1>
    
    <div class="- topic/body body"><p class="- topic/shortdesc shortdesc">Information security policy</p>

        <p class="- topic/p p">Cryptographic Key management refers to the comprehensive processes and infrastructure required to
            control cryptographic keys throughout their lifecycle.</p>
        <section class="- topic/section section"><h2 class="- topic/title title sectiontitle">Purpose</h2>
            
            <p class="- topic/p p">This policy outlines the requirements for protecting cryptographic keys under the
                control of individuals within the <span class="- topic/ph ph">Company</span>. These requirements
                are designed to prevent unauthorized disclosure and subsequent fraudulent use. The
                protection methods outlined will include the following operational and technical
                controls:</p>
            <ul class="- topic/ul ul">
                <li class="- topic/li li">
                    <p class="- topic/p p">Strong Encryption </p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">Secure Distribution </p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">Secure Storage </p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">Cryptoperiod </p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">Rotation</p>
                </li>
            </ul>
        </section>
        <section class="- topic/section section"><h2 class="- topic/title title sectiontitle">Scope</h2>
            
            <p class="- topic/p p">This policy applies to the entire <span class="- topic/ph ph">Company</span>, but particularly to
                individuals involved in any aspect of cryptographic key management.</p>
        </section>
        <section class="- topic/section section"><h2 class="- topic/title title sectiontitle">Audience</h2>
            
            <p class="- topic/p p">This policy is targeted specifically to IT staff, development teams, management,
                external auditors or any other relevant party.</p>
        </section>
        <section class="- topic/section section"><h2 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Compliance</span></h2>
            
            <p class="- topic/p p"><cite class="- topic/cite cite"><span class="- topic/ph ph">PCI-DSS-V4-</span>3.7</cite></p>
        </section>
    </div>
<article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="unique_834108388">
    <h2 class="- topic/title title topictitle2" id="ariaid-title2">Strong encryption</h2>
    <div class="- topic/body body">
        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Policy</span></h3>
            
            
            <div class="- topic/p p">Keys used to protect stored account data must use strong encryption. Strong keys will
                protect data from unauthorized access. Strong encryption is also important for the
                following reasons: <ul class="- topic/ul ul" id="unique_834108388__ul_rfx_1y1_vcc" data-ofbid="unique_834108388__ul_rfx_1y1_vcc">
                    <li class="- topic/li li">
                        <p class="- topic/p p">It prevents unauthorized access to data, protecting user privacy and
                            preventing sensitive data from being intercepted.</p>
                    </li>
                    <li class="- topic/li li">
                        <p class="- topic/p p">It helps prevent data breaches and protects data in transit or at rest.
                        </p>
                    </li>
                    <li class="- topic/li li">
                        <p class="- topic/p p">It ensures that the data received by the recipient is the same as the
                            data that was sent, and that it hasn't been tampered with.</p>
                    </li>
                    <li class="- topic/li li">
                        <p class="- topic/p p">It helps avert financial and/or legal consequences. A data breach can
                            have serious financial and legal consequences for a business, including
                            fines, customer loss, lawsuits, and even bankruptcy.</p>
                    </li>
                    <li class="- topic/li li">
                        <p class="- topic/p p"><span class="- topic/ph ph">For compliance with applicable <a href="../../../reusables/../glossterms/pci-dss.html" title="Payment Card Industry Data Security Standard (PCI DSS)"><dfn class="- topic/term term">Payment Card Industry Data Security Standard (PCI DSS)</dfn></a> requirements.</span></p>
                    </li>
                </ul></div>
        </section>
        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Control and implementation</span></h3>
            
            
            <p class="- topic/p p">Stored account data is encrypted using <a href="../../../glossterms/aes-256.html" title="Advanced Encryption Standard. The AES encryption algorithm, also known as the Rijndael algorithm, is a type of symmetric block cipher that works with 128-bit blocks of data. AES-256 encryption uses the 256-bit key length to encrypt as well as decrypt a block of messages."><dfn class="- topic/term term">AES-256</dfn></a> encryption. </p>
        </section>
        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Compliance</span></h3>
            
            
            <cite class="- topic/cite cite"><span class="- topic/ph ph">PCI-DSS-V4-</span>3.7.1</cite>
        </section>
    </div>
</article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title3" id="crypto_key_secure_distribution">
    <h2 class="- topic/title title topictitle2" id="ariaid-title3">Secure distribution</h2>
    <div class="- topic/body body">

        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Policy</span></h3>
            
            
            <p class="- topic/p p">Keys used to protect stored account data must be securely distributed. Secure key
                distribution is important for data security because it ensures that only authorized
                parties receive the correct keys, and that encrypted data is not compromised. Secure
                distribution is also important for the following reasons: </p>
            <ul class="- topic/ul ul">
                <li class="- topic/li li">
                    <p class="- topic/p p">It provides secrecy and authentication for communication</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">It protects against vulnerability as interception is possible during the
                        exchange.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">It ensures that keys used for encryption and decryption are not compromised,
                        stolen, or tampered with.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">It prevents unauthorized key substitution.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p"><span class="- topic/ph ph">For compliance with applicable <a href="../../../reusables/../glossterms/pci-dss.html" title="Payment Card Industry Data Security Standard (PCI DSS)"><dfn class="- topic/term term">PCI DSS</dfn></a> requirements.</span></p>
                </li>
            </ul>
        </section>
        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Control and implementation</span></h3>
            
            <p class="- topic/p p">Secure distribution of encryption keys is controlled as follows:</p>
            <ul class="- topic/ul ul">
                <li class="- topic/li li">
                    <p class="- topic/p p">Key access is managed through HashiCorp Vault.</p>
                </li>
                
                <li class="- topic/li li">
                    <p class="- topic/p p">Key operations require membership in the ActiveDirectory (AD)
                            <code class="+ topic/ph pr-d/codeph ph codeph">key_custodian</code> security group.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">Key operations involving cleartext secrets require split knowledge from two
                        key custodians.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">Key custodian role is limited to three individuals. Two custodians will be
                        available for applicable key operations and one backup custodian. </p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">Key custodians are required to formally acknowledge (in writing or
                        electronically) that they understand and accept their responsibilities.
                        Acknowledgements are tracked and stored by the group administrator.</p>
                </li>

            </ul>
        </section>
        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Compliance</span></h3>
            
            
            <p class="- topic/p p"><cite class="- topic/cite cite"><span class="- topic/ph ph">PCI-DSS-V4-</span>3.7.2</cite></p>
            <p class="- topic/p p"><cite class="- topic/cite cite"><span class="- topic/ph ph">PCI-DSS-V4-</span>3.7.6</cite></p>
            <p class="- topic/p p"><cite class="- topic/cite cite"><span class="- topic/ph ph">PCI-DSS-V4-</span>3.7.8</cite></p>
        </section>
    </div>
</article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title4" id="crypto-key-mgt-secure-storage">
    <h2 class="- topic/title title topictitle2" id="ariaid-title4">Secure storage</h2>
    <div class="- topic/body body">

        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Policy</span></h3>
            
            
            <p class="- topic/p p">Keys used to protect stored account data must be securely stored. Secure key storage
                is important because it protects cryptographic keys from unauthorized access, which
                helps maintain the integrity and confidentiality of data. Without secure key
                storage, keys can be vulnerable to attacks that extract them from a device's storage
                or application. Secure storage is also important for the following reasons:</p>
            <ul class="- topic/ul ul">
                <li class="- topic/li li">
                    <p class="- topic/p p">It prevents attackers from accessing and downloading a device's flash to
                        extract keys.  </p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">It prevents attackers from taking control of a user's application or
                        privileges to access keys.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">It reduces the chance that they will be compromised.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p"><span class="- topic/ph ph">For compliance with applicable <a href="../../../reusables/../glossterms/pci-dss.html" title="Payment Card Industry Data Security Standard (PCI DSS)"><dfn class="- topic/term term">PCI DSS</dfn></a> requirements.</span></p>
                </li>
            </ul>
        </section>
        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Control and implementation</span>
            </h3>
            
            <p class="- topic/p p">Secure storage of encryption keys is controlled as follows:</p>
            <ul class="- topic/ul ul">
                <li class="- topic/li li">
                    <p class="- topic/p p">Keys are not stored with the data they encrypt.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">Keys that can decrypt data are never be present in source code.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p"><a href="../../../glossterms/data-encrypting-key.html" title="Data Encryption Key (KEK)"><dfn class="- topic/term term">Data Encryption Key (KEK)</dfn></a>s are encrypted with <a href="../../../glossterms/key-encrypting-key.html" title="Key Encryption Key (KEK)"><dfn class="- topic/term term">Key Encryption Key (KEK)</dfn></a>s.</p>
                </li>
                <li class="- topic/li li"><p class="- topic/p p">DEKs are stored in Hashicorp Vault.</p></li>
                <li class="- topic/li li"><p class="- topic/p p">KEKs are stored in a Thales Luna HSM (Hardware Security Module).</p></li>                
                <li class="- topic/li li"><p class="- topic/p p">Vaults are encrypted and access is restricted through a AD accounts. There is
                        only one vault per application, per environment (development, preproduction,
                        and production).</p></li>
            </ul>
        </section>
        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Compliance</span></h3>
            
            <p class="- topic/p p"><cite class="- topic/cite cite"><span class="- topic/ph ph">PCI-DSS-V4-</span>3.7.3</cite></p>
            <p class="- topic/p p"><cite class="- topic/cite cite"><span class="- topic/ph ph">PCI-DSS-V4-</span>3.7.7</cite></p>
        </section>
    </div>

</article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title5" id="crypto-key-mgt-cryptoperiod">
    <h2 class="- topic/title title topictitle2" id="ariaid-title5">Key cryptoperiod</h2>
    <div class="- topic/body body">
        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Policy</span></h3>
            
            <p class="- topic/p p">Keys used to protect stored account data must have a defined <a href="../../../glossterms/cryptoperiod.html" title="A cryptoperiod is the time frame during which a cryptographic key is authorized for use. It's also known as key lifetime or validity period."><dfn class="- topic/term term">cryptoperiod</dfn></a>.
                Cryptoperiods are important for the following reasons:</p>
            <ul class="- topic/ul ul">
                <li class="- topic/li li">
                    <p class="- topic/p p">They limit the amount of exploitable information that could be obtained
                        through <a href="../../../glossterms/cryptanalysis.html" title="Cryptanalysis refers to the process of analyzing information systems in order to understand hidden aspects of the systems. Cryptanalysis is used to breach cryptographic security systems and gain access to the contents of encrypted messages, even if the cryptographic key is unknown."><dfn class="- topic/term term">Cryptanalysis</dfn></a> after a key change</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p"> They make cryptographic algorithms less susceptible to cryptanalysis.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">They make keys less susceptible to attack, reducing data risk.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p"><span class="- topic/ph ph">For compliance with applicable <a href="../../../reusables/../glossterms/pci-dss.html" title="Payment Card Industry Data Security Standard (PCI DSS)"><dfn class="- topic/term term">PCI DSS</dfn></a> requirements.</span></p>
                </li>
            </ul>
        </section>
        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Control and implementation</span></h3>
            
            <p class="- topic/p p">Keys are destroyed when their <strong class="+ topic/ph hi-d/b ph b">retired</strong> cryptoperiod has expired.</p>
            <div class="table-container"><table class="- topic/table table frame-all" data-cols="3"><caption></caption><colgroup><col style="width:33.33333333333333%"/><col style="width:33.33333333333333%"/><col style="width:33.33333333333333%"/></colgroup><thead class="- topic/thead thead">
                        <tr class="- topic/row">
                            <th class="- topic/entry entry colsep-0 rowsep-0" id="crypto-key-mgt-cryptoperiod__entry__1">State</th>
                            <th class="- topic/entry entry colsep-0 rowsep-0" id="crypto-key-mgt-cryptoperiod__entry__2">Usage</th>
                            <th class="- topic/entry entry colsep-0 rowsep-0" id="crypto-key-mgt-cryptoperiod__entry__3">Cryptoperiod</th>
                        </tr>
                    </thead><tbody class="- topic/tbody tbody">
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0" headers="crypto-key-mgt-cryptoperiod__entry__1">active</td>
                            <td class="- topic/entry entry colsep-0 rowsep-0" headers="crypto-key-mgt-cryptoperiod__entry__2">encryption and decryption</td>
                            <td class="- topic/entry entry colsep-0 rowsep-0" headers="crypto-key-mgt-cryptoperiod__entry__3">two years</td>
                        </tr>
                        <tr class="- topic/row">
                            <td class="- topic/entry entry colsep-0 rowsep-0" headers="crypto-key-mgt-cryptoperiod__entry__1">retired</td>
                            <td class="- topic/entry entry colsep-0 rowsep-0" headers="crypto-key-mgt-cryptoperiod__entry__2">decryption only</td>
                            <td class="- topic/entry entry colsep-0 rowsep-0" headers="crypto-key-mgt-cryptoperiod__entry__3">one year</td>
                        </tr>
                    </tbody></table></div>
        </section>
        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Compliance</span></h3>
            
            <cite class="- topic/cite cite"><span class="- topic/ph ph">PCI-DSS-V4-</span>3.7.4</cite>
        </section>
    </div>

</article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title6" id="crypto-key-mgt-rotation">
    <h2 class="- topic/title title topictitle2" id="ariaid-title6">Key rotation</h2>
    <div class="- topic/body body">
        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Policy</span></h3>
            
            <p class="- topic/p p">Keys used to protect stored account data must be rotated at the end of the
                cryptoperiod. Key rotation is important for the following reasons:</p>
            <ul class="- topic/ul ul">
                <li class="- topic/li li">
                    <p class="- topic/p p">It limits the amount of data that is encrypted with the same key, which
                        reduces the impact if that key is compromised.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">It prevents sustained access making it harder for unauthorized users to gain
                        access to sensitive data for extended periods of time.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">It helps systems recover more quickly after security lapses.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">It prevents cracking by making any progress made on cracking a key
                        obsolete.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p"><span class="- topic/ph ph">For compliance with applicable <a href="../../../reusables/../glossterms/pci-dss.html" title="Payment Card Industry Data Security Standard (PCI DSS)"><dfn class="- topic/term term">PCI DSS</dfn></a> requirements.</span></p>
                </li>
            </ul>
            
        </section>
        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Control and implementation</span></h3>
            
            <p class="- topic/p p">Keys are rotated upon occurrence of the following:</p>
            <ul class="- topic/ul ul">
                <li class="- topic/li li">
                    <p class="- topic/p p">At the end of its cryptoperiod.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">If integrity of the key has been weakened.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">If suspected of or known to be compromised.</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">When transitioning to a new algorithm.</p>
                </li>
            </ul>
            <p class="- topic/p p">Keys are rotated every 90 days. The following operations are performed at the time of
                rotation.</p>
            <ul class="- topic/ul ul">
                <li class="- topic/li li">
                    <p class="- topic/p p">keys are generated</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">keys are retired</p>
                </li>
                <li class="- topic/li li">
                    <p class="- topic/p p">keys are destroyed</p>
                </li>
            </ul>
            <p class="- topic/p p">Key rotations are documented for tracking purposes and historical record.</p>
        </section>
        <section class="- topic/section section"><h3 class="- topic/title title sectiontitle"><span class="- topic/ph ph">Compliance</span></h3>
            
            <p class="- topic/p p"><cite class="- topic/cite cite"><span class="- topic/ph ph">PCI-DSS-V4-</span>3.7.5</cite></p>
        </section>
    </div>

</article><article class="- topic/topic task/task topic task nested1" aria-labelledby="ariaid-title7" id="crypto-key-rotate-hashicorp-java">
    <h2 class="- topic/title title topictitle2" id="ariaid-title7">Rotating keys with Vault</h2>
    
    <div class="- topic/body task/taskbody body taskbody"><div class="- topic/abstract abstract"><cite class="- topic/cite cite">PCI-DSS-V4-3.7.5 </cite></div>
        <section class="- topic/section task/prereq section prereq">
            <p class="- topic/p p">Identify three key custodians to apply the split knowledge 3-share threshold. Three
                key custodians will be required to complete the rotation.</p>
        </section>
        <section class="- topic/section task/context section context">
            <p class="- topic/p p">Using Vault, rotate keys as follows:</p>
        </section>
        <section class="- topic/ol task/steps ol steps"><ol class="- topic/ol task/steps ol steps"><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Ensure split knowledge has been setup for Vault Unsealing. Otherwise, setup
                    split knowledge as follows: </span>
                <ol type="a" class="- topic/ol task/substeps ol substeps">
                    <li class="- topic/li task/substep li substep substepexpand">
                        <span class="- topic/ph task/cmd ph cmd">Use the <code class="+ topic/ph pr-d/codeph ph codeph">vault operator init</code> command to initial
                            Vault.</span>
                        <div class="- topic/itemgroup task/info itemgroup info">
                            <div class="- topic/p p">
                                <pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>vault operator init -key-shares=5 -key-threshold=3                           </code></pre>
                            </div>
                            <ul class="- topic/ul ul">
                                <li class="- topic/li li">
                                    <p class="- topic/p p">Set <code class="+ topic/ph pr-d/codeph ph codeph">-key-shares=5</code>: This splits the master
                                        key into 5 parts (key shares). </p>
                                </li>
                                <li class="- topic/li li">
                                    <p class="- topic/p p">Set <code class="+ topic/ph pr-d/codeph ph codeph">-key-threshold=3</code>: At least 3 key shares
                                        are required to unseal Vault.</p>
                                </li>
                            </ul>
                        </div>
                    </li>
                    <li class="- topic/li task/substep li substep substepexpand">
                        <span class="- topic/ph task/cmd ph cmd">Use the <code class="+ topic/ph pr-d/codeph ph codeph">vault operator unseal</code> command to unseal
                            Vault.</span>
                        <div class="- topic/itemgroup task/info itemgroup info">
                            <div class="- topic/p p">
                                <pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>vault operator unseal &lt;unseal_key_1&gt;
vault operator unseal &lt;unseal_key_2&gt;
vault operator unseal &lt;unseal_key_3&gt;                     </code></pre>
                            </div>
                            <ul class="- topic/ul ul">
                                <li class="- topic/li li">
                                    <p class="- topic/p p">Set <code class="+ topic/ph pr-d/codeph ph codeph">-key-shares=5</code>: This splits the master
                                        key into 5 parts (key shares). </p>
                                </li>
                                <li class="- topic/li li">
                                    <p class="- topic/p p">Set <code class="+ topic/ph pr-d/codeph ph codeph">-key-threshold=3</code>: At least 3 key shares
                                        are required to unseal Vault.</p>
                                </li>
                            </ul>
                            <p class="- topic/p p">When Vault is sealed, key custodians must collaborate to unseal it.
                                In this case, three out of the five key shares will be needed to
                                unseal Vault.</p>
                        </div>
                    </li>
                </ol>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Initialize the Vault client to interact with the Vault server. Set the Vault
                    server URL and authentication token.</span>
                <div class="- topic/itemgroup task/info itemgroup info">
                    <pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>import com.bettercloud.vault.Vault;
import com.bettercloud.vault.VaultConfig;

public class VaultKeyRotation {
    public static void main(String[] args) throws Exception {
    
    // Vault Configuration
    VaultConfig config = new VaultConfig()
    .address("https://127.0.0.1:8200")  // Vault URL
    .token("s.xxxxxxxx")  // Vault token
    .build();
                        
    Vault vault = new Vault(config);
    }
}                 </code></pre>
                </div>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Use the <code class="+ topic/ph pr-d/codeph ph codeph">vault write</code> command to generate the keys.</span>
                <div class="- topic/itemgroup task/info itemgroup info">
                    <pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>vault write keymgmt/keys/my-new-key type="aes256"             </code></pre>
                </div>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Split the keys into five parts with a 3-share threshold.</span>
                <div class="- topic/itemgroup task/info itemgroup info">
                    <pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>SecretShare splitKey = new SecretShare(3, 5);
List&lt;SecretShare.ShareInfo&gt; shares = splitKey.split(secretKey);               </code></pre>
                </div>
                <div class="- topic/itemgroup task/stepresult itemgroup stepresult">This will provide five parts of the key, and any three parts can be used
                    to reconstruct it.</div>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Rotate the existing keys.</span>
                <div class="- topic/itemgroup task/info itemgroup info">
                    <pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>vault.logical()
.write("keymgmt/keys/my-new-key/rotate", null);                 </code></pre>
                </div>
                <div class="- topic/itemgroup task/stepresult itemgroup stepresult">The keys are rotated with new version.</div>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Update the key consumers.</span>
                <div class="- topic/itemgroup task/info itemgroup info"><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>vault.logical()
// Retrieve latest key details for updating services
LogicalResponse readKeyResponse = vault.logical()
.read("keymgmt/keys/my-new-key");
                    
System.out.println("Key details: " + readKeyResponse.getData());             </code></pre><p class="- topic/p p">Ensure
                        that all consumers or services using the key are updated to use the latest
                        version</p></div>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Reconstruct the keys.</span>
                <div class="- topic/itemgroup task/info itemgroup info"><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>vault.logical()
// Reconstruct the key from 3 shares
SecretShare.CombineOutput result = splitKey.combine(share1, share2, share3);
byte[] reconstructedKey = result.getSecret();            </code></pre></div>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Backup, Archive, and Audit key shares.</span>
                <div class="- topic/itemgroup task/info itemgroup info">
                    <pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>// Enable and access audit logs
vault.audit().enable("file", "file_path=/var/log/vault_audit.log");          </code></pre>
                    <p class="- topic/p p">Ensure secure storage and auditing of key shares. Track who holds which key
                        share. </p>
                </div>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd"> Retire keys.</span>
                <div class="- topic/itemgroup task/info itemgroup info">
                    <pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>// Retire the old key
vault.logical()
.write("keymgmt/keys/my-new-key/retire", null);              </code></pre>
                </div>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Destroy keys.</span>
                <div class="- topic/itemgroup task/info itemgroup info">
                    <pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>// Delete key from Vault
vault.logical()
.delete("keymgmt/keys/my-new-key");                                         </code></pre>
                    <p class="- topic/p p">When a key is no longer needed or has been compromised, destroy it and its
                        shares. In Vault, keys can be deleted permanently.</p>
                </div>
            </li></ol></section>
    </div>

</article></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">On this page</div><ul><li class="topic-item"><a href="#unique_834108388" data-tocid="unique_834108388">Strong encryption</a></li><li class="topic-item"><a href="#crypto_key_secure_distribution" data-tocid="crypto_key_secure_distribution">Secure distribution</a></li><li class="topic-item"><a href="#crypto-key-mgt-secure-storage" data-tocid="crypto-key-mgt-secure-storage">Secure storage</a></li><li class="topic-item"><a href="#crypto-key-mgt-cryptoperiod" data-tocid="crypto-key-mgt-cryptoperiod">Key cryptoperiod</a></li><li class="topic-item"><a href="#crypto-key-mgt-rotation" data-tocid="crypto-key-mgt-rotation">Key rotation</a></li><li class="topic-item"><a href="#crypto-key-rotate-hashicorp-java" data-tocid="crypto-key-rotate-hashicorp-java">Rotating keys with Vault</a></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
    Generated by <a class="oxyFooter" href="http://www.oxygenxml.com/xml_webhelp.html" target="_blank" rel="noopener">&lt;oXygen/&gt; XML WebHelp</a> - Evaluation Version
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>